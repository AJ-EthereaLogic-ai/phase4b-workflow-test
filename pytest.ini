# ============================================================================
# File: pytest.ini
# pytest configuration with coverage settings for Phase4B Test Project
# ============================================================================

[pytest]
# Minimum Python version
minversion = 7.0

# Asyncio plugin configuration
asyncio_default_fixture_loop_scope = function

# Test discovery patterns
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Test paths
testpaths = tests

# Coverage settings
addopts =
    # Coverage measurement (app code only - add --cov=adws if contributing to framework)
    --cov=app

    # Coverage reporting
    --cov-report=term-missing
    --cov-report=html:docs/reports/coverage/htmlcov
    --cov-report=xml:docs/reports/coverage/coverage.xml
    --cov-report=json:docs/reports/coverage/coverage.json

    # Coverage thresholds (increase as your project grows)
    # Starting low for initial template scaffolding - increase to 80+ as you add features
    --cov-fail-under=2

    # Verbose output
    --verbose
    --showlocals

    # Show summary
    --tb=short

    # Color output
    --color=yes

    # Strict markers
    --strict-markers

    # Warnings
    -ra

# Markers for categorizing tests
markers =
    asyncio: marks tests as async tests
    slow: marks tests as slow (deselect with '-m "not slow"')
    integration: marks tests as integration tests
    unit: marks tests as unit tests

# Warning filters
filterwarnings =
    # Ignore ResourceWarning from asyncio event loops in external libraries
    ignore::ResourceWarning:asyncio.base_events

    # Ignore datetime.utcnow() deprecation from external pydantic library
    ignore:datetime\.datetime\.utcnow.*:DeprecationWarning:pydantic

# Logging
log_cli = false
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Coverage source directories
[coverage:run]
source = app
omit =
    */tests/*
    */test_*.py
    */__pycache__/*
    */site-packages/*
    */venv/*
    */.venv/*

[coverage:report]
# Precision for percentages
precision = 2

# Show lines missing coverage
show_missing = True

# Skip empty files
skip_empty = True

# Exclude patterns
exclude_lines =
    # Standard exclusions
    pragma: no cover
    def __repr__
    def __str__
    raise AssertionError
    raise NotImplementedError
    if __name__ == "__main__":
    if TYPE_CHECKING:
    @abstractmethod
    @abc.abstractmethod

    # Type checking only
    if typing.TYPE_CHECKING:

    # Defensive programming
    except ImportError

    # Debug code
    if settings.DEBUG

    # Platform-specific
    if sys.platform

[coverage:html]
directory = docs/reports/coverage/htmlcov
title = Phase4B Test Project Test Coverage Report

[coverage:xml]
output = docs/reports/coverage/coverage.xml

[coverage:json]
output = docs/reports/coverage/coverage.json
pretty_print = True
